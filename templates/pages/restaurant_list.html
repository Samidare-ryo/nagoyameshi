{# templates/pages/restaurant_list.html #}
{% extends "base.html" %}


{% block main %}
<div class="max-w-5xl mx-auto my-10 px-4">

  <h1 class="text-3xl font-bold mb-6 text-accent2">åº—èˆ—ä¸€è¦§</h1>

  <!-- ğŸ” æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ  -->
  <form method="get" class="mb-6 flex flex-col sm:flex-row gap-3 items-start sm:items-center">
    <input
      type="text"
      name="q"
      value="{{ query }}"
      placeholder="åº—èˆ—åãƒ»ä½æ‰€ãƒ»èª¬æ˜ã§æ¤œç´¢"
      class="flex-grow border rounded-lg px-4 py-2 focus:ring-2 focus:ring-accent2"
    />
    <select name="sort" class="border rounded-lg px-3 py-2">
      <option value="rating" {% if sort == "rating" %}selected{% endif %}>è©•ä¾¡ãŒé«˜ã„é †</option>
      <option value="updated" {% if sort == "updated" %}selected{% endif %}>æ›´æ–°æ—¥ãŒæ–°ã—ã„é †</option>
      <option value="name" {% if sort == "name" %}selected{% endif %}>åº—èˆ—åé †</option>
    </select>
    <button
      type="submit"
      class="px-4 py-2 rounded-lg bg-accent2 text-white font-semibold shadow hover:bg-accent2/80 transition"
    >
      æ¤œç´¢
    </button>
  </form>

  {% if restaurants %}
    <!-- ğŸ“œ çµæœä¸€è¦§ï¼ˆã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä»˜ãï¼‰ -->
    <div class="h-[600px] overflow-y-scroll border-t border-gray-300 pt-4 space-y-4">
      {% for restaurant in restaurants %}
        <div class="bg-white p-4 rounded-lg shadow flex justify-between items-center border border-gray-200">
          <div>
            <h2 class="text-lg font-semibold text-gray-800">{{ restaurant.name }}</h2>
            {% if restaurant.rating %}
              <p class="text-sm text-yellow-600 font-semibold">è©•ä¾¡: â˜…{{ restaurant.rating|floatformat:1 }}</p>
            {% endif %}
            {% if restaurant.address %}
              <p class="text-sm text-gray-500">ä½æ‰€: {{ restaurant.address }}</p>
            {% endif %}
            <p class="text-xs text-gray-400">æœ€çµ‚æ›´æ–°: {{ restaurant.updated_at|date:"Y/m/d H:i" }}</p>
          </div>

          <div class="flex gap-2">
            <a href="{% url 'restaurant_detail' restaurant.id %}"
               class="px-4 py-2 rounded-lg bg-accent2 text-white text-sm font-semibold shadow hover:bg-accent2/80 transition">
              è©³ç´°
            </a>
            <form method="post" action="{% url 'favorite_toggle' restaurant.id %}">
              {% csrf_token %}
              <button type="submit"
                      class="px-4 py-2 rounded-lg bg-red-500 text-white text-sm font-semibold shadow hover:bg-red-600 transition">
                ãŠæ°—ã«å…¥ã‚Š
              </button>
            </form>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p class="text-center text-gray-500 mt-6">è©²å½“ã™ã‚‹åº—èˆ—ã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>
  {% endif %}

</div>
{% endblock %}